import pandas as pd 
from IPython.display import display

df = pd.read_csv("../data/raw/ca_san_diego.sample.csv.zip",compression="zip")

display(df.head())
print("Rows:", df.shape[0])
print("Columns:", df.shape[1])

df.info() # schema (plan) and missing values

print("\nSummary Statistics:")
display(df.describe(include="all").T)

print("\nColumn Names:")
print(df.columns.tolist())

# top 20 missing values
missing = df.isna().sum().sort_values(ascending=False)
display(missing.head(20).to_frame("missing_count"))

# numerical vs. categorical columns
numeric_cols = df.select_dtypes(include="number").columns
categorical_cols = df.select_dtypes(exclude="number").columns 

print("Numeric columns:", len(numeric_cols))
print("Categorical columns:", len(categorical_cols))

core_fields = ["saleprice","saledate","num_bedrooms","num_bath","num_bath_partial","yearbuilt","improvval","landval","parval","usedesc","zoning"]

missing_core = [c for c in core_fields if c not in df.columns]
print("Missing core fields:",missing_core)

display(df[[c for c in core_fields if c in df.columns]].head())
